generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model ImportOrder {
    id              String            @id @default(uuid())
    orderNumber     String            @unique
    
    issueDate       DateTime          @default(now())
    expectedArrival DateTime?
    actualArrival   DateTime?
    
    providerId      String
    providerName    String?           // Desnormalizado para referencia rápida
    incoterm        String?
    
    status          ImportOrderStatus @default(Pendiente)
    items           ImportOrderItem[]
    
    warehouseId     String            // ID del almacén donde se recibirá 
    warehouseName   String?           // Desnormalizado para referencia rápida
    
    createdAt       DateTime          @default(now())
    updatedAt       DateTime          @updatedAt

    @@map("import_orders")
}

model ImportOrderItem {
    id              Int         @id @default(autoincrement())
    importOrderId   String
    importOrder     ImportOrder @relation(fields: [importOrderId], references: [id], onDelete: Cascade)
    
    productId       String
    productName     String
    
    quantityOrdered  Int
    quantityReceived Int?       @default(0)
    
    priceUnit       Decimal     @db.Decimal(12, 2)
    currency        String      @default("USD")
    
    createdAt       DateTime    @default(now())
    updatedAt       DateTime    @updatedAt

    @@map("import_order_items")
}

enum ImportOrderStatus {
    Pendiente
    Cursando   
    Recibido
    Cancelado
    Completado
}